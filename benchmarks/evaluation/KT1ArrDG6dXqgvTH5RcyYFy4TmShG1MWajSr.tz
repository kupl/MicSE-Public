parameter (or (or (unit %buy) (unit %withdraw)) (nat %withdraw_Spice));
storage (pair (pair %spice (address %fa2_address) (nat %token_id))
              (pair (nat %phase)
                    (pair (timestamp %phase_one_start)
                          (pair (timestamp %phase_two_start)
                                (pair (timestamp %phase_three_start)
                                      (pair (mutez %price)
                                            (pair (bool %batch_protect)
                                                  (pair (nat %purchase_cap)
                                                        (pair (mutez %purchase_cap_per_tx)
                                                              (pair (nat %amt_sold)
                                                                    (pair (address %admin)
                                                                          (pair
                                                                            (big_map %buyers address
                                                                                             timestamp)
                                                                            (pair
                                                                              (option %current_list (big_map
                                                                                                     address
                                                                                                     bool))
                                                                              (pair
                                                                                (big_map %phase_one_list
                                                                                  address
                                                                                  bool)
                                                                                (big_map %phase_two_list
                                                                                  address
                                                                                  bool)))))))))))))));
code { LAMBDA
         (pair (pair address address) (pair nat (pair address nat)))
         operation
         { UNPAIR ;
           UNPAIR ;
           DIG 2 ;
           UNPAIR ;
           NIL (pair nat nat) ;
           SWAP ;
           DUP 3 ;
           CDR ;
           PAIR ;
           CONS ;
           SWAP ;
           CAR ;
           PAIR ;
           DIG 2 ;
           PAIR ;
           SWAP ;
           PAIR ;
           UNPAIR 3 ;
           DUP 3 ;
           CDR ;
           MAP { DUP 3 ; PAIR } ;
           DIG 2 ;
           DROP ;
           DIG 2 ;
           CAR ;
           CONTRACT %transfer (list (pair (address %from_)
                                         (list %txs (pair (address %to_)
                                                         (pair (nat %token_id) (nat %amount)))))) ;
           IF_NONE { PUSH string "Invalid FA2 Address" ; FAILWITH } {} ;
           PUSH mutez 0 ;
           NIL (pair address (list (pair address (pair nat nat)))) ;
           DIG 3 ;
           DIG 4 ;
           PAIR ;
           CONS ;
           TRANSFER_TOKENS } ;
       SWAP ;
       UNPAIR ;
       SWAP ;
       DUP ;
       DUG 2 ;
       CDR ;
       CDR ;
       CDR ;
       CDR ;
       CAR ;
       NOW ;
       COMPARE ;
       GT ;
       PUSH nat 2 ;
       DUP 4 ;
       CDR ;
       CAR ;
       COMPARE ;
       EQ ;
       AND ;
       IF
         { SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           PUSH nat 3 ;
           PAIR ;
           DIG 2 ;
           CAR ;
           PAIR ;
           DUP ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           PUSH mutez 5000000 ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           CAR ;
           PAIR ;
           DUP ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           PUSH nat 40000000 ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           CAR ;
           PAIR ;
           DUP ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           PUSH mutez 1000000000000 ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           CAR ;
           PAIR ;
           DUP ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           PUSH bool False ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           CAR ;
           PAIR ;
           DUP ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           NONE (big_map address bool) ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CAR ;
           PAIR ;
           SWAP ;
           CAR ;
           PAIR }
         { SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           NOW ;
           COMPARE ;
           GT ;
           PUSH nat 1 ;
           DUP 4 ;
           CDR ;
           CAR ;
           COMPARE ;
           EQ ;
           AND ;
           IF
             { SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               PUSH nat 2 ;
               PAIR ;
               DUP 3 ;
               CAR ;
               PAIR ;
               DUP ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               PUSH mutez 3000000 ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               CAR ;
               PAIR ;
               DUP ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               PUSH nat 30000000 ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               CAR ;
               PAIR ;
               DUP ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               PUSH mutez 1000000000000 ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               CAR ;
               PAIR ;
               DUP ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               PUSH bool True ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               CAR ;
               PAIR ;
               DUP ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               DIG 3 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               SOME ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               CAR ;
               PAIR }
             { SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CAR ;
               NOW ;
               COMPARE ;
               GT ;
               PUSH nat 0 ;
               DUP 4 ;
               CDR ;
               CAR ;
               COMPARE ;
               EQ ;
               AND ;
               IF
                 { SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   PUSH nat 1 ;
                   PAIR ;
                   DUP 3 ;
                   CAR ;
                   PAIR ;
                   DUP ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   PUSH mutez 1000000 ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   CAR ;
                   PAIR ;
                   DUP ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   PUSH nat 20000000 ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   CAR ;
                   PAIR ;
                   DUP ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   PUSH mutez 1000000000 ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   CAR ;
                   PAIR ;
                   DUP ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   PUSH bool True ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   CAR ;
                   PAIR ;
                   DUP ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   DIG 3 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   SOME ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   DUP ;
                   DUG 2 ;
                   CDR ;
                   CAR ;
                   PAIR ;
                   SWAP ;
                   CAR ;
                   PAIR }
                 { SWAP } } } ;
       SWAP ;
       IF_LEFT
         { IF_LEFT
             { DROP ;
               PUSH string "NOT_ALLOWED" ;
               PUSH bool True ;
               DUP 3 ;
               SENDER ;
               SWAP ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               IF_NONE
                 { DROP ; PUSH bool True }
                 { SWAP ; GET ; IF_NONE { PUSH string "NOT_ON_LIST" ; FAILWITH } {} } ;
               COMPARE ;
               EQ ;
               NOT ;
               IF { FAILWITH } { DROP } ;
               AMOUNT ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               COMPARE ;
               GT ;
               IF { PUSH string "AMT_TOO_HIGH" ; FAILWITH } {} ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PUSH nat 1000000 ;
               PUSH nat 100 ;
               DIG 3 ;
               MUL ;
               MUL ;
               EDIV ;
               IF_NONE { PUSH string "DIV by 0" ; FAILWITH } {} ;
               CAR ;
               DUP ;
               DUP 3 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               ADD ;
               PUSH nat 1000000 ;
               DUP 4 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               MUL ;
               SWAP ;
               DUP ;
               DUG 2 ;
               COMPARE ;
               GT ;
               IF { PUSH string "PURCHASE_CAP" ; FAILWITH } {} ;
               PUSH bool True ;
               DUP 4 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               COMPARE ;
               EQ ;
               IF
                 { DUP 3 ;
                   SENDER ;
                   SWAP ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CDR ;
                   CAR ;
                   SWAP ;
                   GET ;
                   IF_NONE
                     { UNIT }
                     { PUSH int 120 ;
                       ADD ;
                       NOW ;
                       COMPARE ;
                       GT ;
                       IF { UNIT } { PUSH string "BATCH_PROTECT" ; FAILWITH } } }
                 { UNIT } ;
               DROP ;
               DUP 3 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               NOW ;
               SOME ;
               SENDER ;
               UPDATE ;
               DUP 4 ;
               CAR ;
               DIG 3 ;
               PAIR ;
               SENDER ;
               SELF_ADDRESS ;
               PAIR ;
               PAIR ;
               DIG 4 ;
               SWAP ;
               EXEC ;
               DUP 4 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               DIG 3 ;
               PAIR ;
               DUP 4 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               DUP 4 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               DUP 4 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               DUP 4 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               DUP 4 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               DUP 4 ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               DUP 4 ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               DUP 4 ;
               CDR ;
               CAR ;
               PAIR ;
               DIG 3 ;
               CAR ;
               PAIR ;
               DUP ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               DIG 3 ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               DUP ;
               DUG 2 ;
               CDR ;
               CAR ;
               PAIR ;
               SWAP ;
               CAR ;
               PAIR ;
               NIL operation ;
               DIG 2 ;
               CONS ;
               PAIR }
             { DROP ;
               SWAP ;
               DROP ;
               DUP ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CDR ;
               CAR ;
               SENDER ;
               COMPARE ;
               NEQ ;
               IF
                 { DROP ; PUSH string "not_admin" ; FAILWITH }
                 { SENDER ;
                   CONTRACT unit ;
                   IF_NONE { PUSH string "0" ; FAILWITH } {} ;
                   SWAP ;
                   NIL operation ;
                   DIG 2 ;
                   BALANCE ;
                   UNIT ;
                   TRANSFER_TOKENS ;
                   CONS ;
                   PAIR } } }
         { SWAP ;
           DUP ;
           DUG 2 ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CDR ;
           CAR ;
           SENDER ;
           COMPARE ;
           NEQ ;
           IF
             { DROP 3 ; PUSH string "not_admin" ; FAILWITH }
             { PUSH int 432000 ;
               DUP 3 ;
               CDR ;
               CDR ;
               CAR ;
               ADD ;
               NOW ;
               COMPARE ;
               LT ;
               IF
                 { DROP 3 ; PUSH string "sale_still_open" ; FAILWITH }
                 { SWAP ;
                   DUP ;
                   DUG 2 ;
                   CAR ;
                   SWAP ;
                   PAIR ;
                   SENDER ;
                   SELF_ADDRESS ;
                   PAIR ;
                   PAIR ;
                   DIG 2 ;
                   SWAP ;
                   EXEC ;
                   SWAP ;
                   NIL operation ;
                   DIG 2 ;
                   CONS ;
                   PAIR } } } }